{"remainingRequest":"/Users/zhwtest/Desktop/VueProjects/admin_study_ui/node_modules/babel-loader/lib/index.js!/Users/zhwtest/Desktop/VueProjects/admin_study_ui/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhwtest/Desktop/VueProjects/admin_study_ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhwtest/Desktop/VueProjects/admin_study_ui/src/components/user/ExportExcelCommon.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhwtest/Desktop/VueProjects/admin_study_ui/src/components/user/ExportExcelCommon.vue","mtime":1582358794828},{"path":"/Users/zhwtest/Desktop/VueProjects/admin_study_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhwtest/Desktop/VueProjects/admin_study_ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhwtest/Desktop/VueProjects/admin_study_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhwtest/Desktop/VueProjects/admin_study_ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIudG8tZml4ZWQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBGaWxlU2F2ZXIgZnJvbSAnZmlsZS1zYXZlcic7CmltcG9ydCBYTFNYIGZyb20gJ3hsc3gnOwpleHBvcnQgZGVmYXVsdCB7CiAgcHJvcHM6IHsKICAgIGV4cG9ydEV4Y2VsSW5mbzogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgICJkZWZhdWx0IjogW10KICAgIH0sCiAgICBleHBvcnRFeGNlbEFycnk6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgICJkZWZhdWx0IjogW10KICAgIH0sCiAgICB0YWJsZURhdGE6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgICJkZWZhdWx0IjogW10KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIGV4Y2Vs5a+85Ye6CiAgICBleHBvcnRFeGNlbDogZnVuY3Rpb24gZXhwb3J0RXhjZWwoKSB7CiAgICAgIHZhciB4bHN4UGFyYW0gPSB7CiAgICAgICAgcmF3OiB0cnVlCiAgICAgIH07IC8vIOWvvOWHuueahOWGheWuueWPquWBmuino+aekO+8jOS4jei/m+ihjOagvOW8j+i9rOaNogoKICAgICAgdmFyIHdiID0gWExTWC51dGlscy50YWJsZV90b19ib29rKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdGhpcy5leHBvcnRFeGNlbEluZm8uZXhjZWxJZCksIHhsc3hQYXJhbSk7CiAgICAgIHZhciB3Ym91dCA9IFhMU1gud3JpdGUod2IsIHsKICAgICAgICBib29rVHlwZTogJ3hsc3gnLAogICAgICAgIGJvb2tTU1Q6IHRydWUsCiAgICAgICAgdHlwZTogJ2FycmF5JwogICAgICB9KTsKCiAgICAgIHRyeSB7CiAgICAgICAgRmlsZVNhdmVyLnNhdmVBcyhuZXcgQmxvYihbd2JvdXRdLCB7CiAgICAgICAgICB0eXBlOiAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJwogICAgICAgIH0pLCB0aGlzLmV4cG9ydEV4Y2VsSW5mby5leGNlbE5hbWUpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJykgY29uc29sZS5sb2coZSwgd2JvdXQpOwogICAgICB9CgogICAgICByZXR1cm4gd2JvdXQ7CiAgICB9LAogICAgLy8g6KGo5qC8Zm9ybWF0dGVy5pWw5o2u5qC85byP5YyWCiAgICBmb3JtYXR0ZXI6IGZ1bmN0aW9uIGZvcm1hdHRlcih2YWx1ZSwgaXRlbSwgcm93LCBwcm9wKSB7CiAgICAgIC8vIOmSiOWvuXRhYmxl5LitaXRlbeWkmuWxguWvueixoeWxgue6p+eahOaDheWGtQogICAgICBpZiAocHJvcC5pbmRleE9mKCcuJykgPiAwKSB7CiAgICAgICAgdmFyIHRlbXAgPSBwcm9wLnNwbGl0KCcuJyk7IC8vIGl0ZW3kuK3ltYzlpZfkuKTlsYIKCiAgICAgICAgaWYgKHRlbXAubGVuZ3RoID09PSAyKSB7CiAgICAgICAgICB2YXIgX3RlbXAgPSBwcm9wLnNwbGl0KCcuJyk7CgogICAgICAgICAgaWYgKGl0ZW0uZm9ybWF0dGVyVHlwZSA9PT0gJ2NvbW1vbi10eXBlJykgewogICAgICAgICAgICAvLyDpgJrnlKjnsbvlnovovazmjaIKICAgICAgICAgICAgdmFyIGFycnkgPSBpdGVtLmZvcm1hdHRlckluZm87CgogICAgICAgICAgICBmb3IgKHZhciBpIGluIGFycnkpIHsKICAgICAgICAgICAgICBpZiAoYXJyeVtpXS52YWx1ZSA9PT0gcm93W190ZW1wWzBdXVtfdGVtcFsxXV0pIHsKICAgICAgICAgICAgICAgIHJldHVybiBhcnJ5W2ldLmxhYmVsOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChpdGVtLmZvcm1hdHRlclR5cGUgPT09ICd0aW1lLXR5cGUnKSB7CiAgICAgICAgICAgIC8vIOaXtumXtOagh+WHhuagvOW8j+WMlgogICAgICAgICAgICBpZiAoIWdsb2JhbC5pc051bGwocm93W190ZW1wWzBdXVtfdGVtcFsxXV0pKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHJvd1tfdGVtcFswXV1bX3RlbXBbMV1dLnN1YnN0cmluZygwLCByb3dbX3RlbXBbMF1dW190ZW1wWzFdXS5sZW5ndGggLSAyKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChpdGVtLmZvcm1hdHRlclR5cGUgPT09ICdhbW91bnQtdHlwZScpIHsKICAgICAgICAgICAgLy8g6YeR6aKd6L2s5o2iCiAgICAgICAgICAgIHJldHVybiAocm93W190ZW1wWzBdXVtfdGVtcFsxXV0gLyAxMDApLnRvRml4ZWQoMik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIGl0ZW3kuK3ml6DltYzlpZflr7nosaEKICAgICAgICB2YXIgX3RlbXAyID0gcHJvcC5zcGxpdCgnLicpOwoKICAgICAgICBpZiAoaXRlbS5mb3JtYXR0ZXJUeXBlID09PSAnY29tbW9uLXR5cGUnKSB7CiAgICAgICAgICAvLyDpgJrnlKjnsbvlnovovazmjaIKICAgICAgICAgIHZhciBfYXJyeSA9IGl0ZW0uZm9ybWF0dGVySW5mbzsKCiAgICAgICAgICBmb3IgKHZhciBfaSBpbiBfYXJyeSkgewogICAgICAgICAgICBpZiAoX2FycnlbX2ldLnZhbHVlID09PSB2YWx1ZSkgewogICAgICAgICAgICAgIHJldHVybiBfYXJyeVtfaV0ubGFiZWw7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGl0ZW0uZm9ybWF0dGVyVHlwZSA9PT0gJ3RpbWUtdHlwZScpIHsKICAgICAgICAgIC8vIOaXtumXtOagh+WHhuagvOW8j+WMlgogICAgICAgICAgaWYgKCFnbG9iYWwuaXNOdWxsKHJvd1tfdGVtcDJbMF1dW190ZW1wMlsxXV0pKSB7CiAgICAgICAgICAgIHJldHVybiB2YWx1ZS5zdWJzdHJpbmcoMCwgdmFsdWUubGVuZ3RoIC0gMik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChpdGVtLmZvcm1hdHRlclR5cGUgPT09ICdhbW91bnQtdHlwZScpIHsKICAgICAgICAgIC8vIOmHkeminei9rOaNogogICAgICAgICAgcmV0dXJuICh2YWx1ZSAvIDEwMCkudG9GaXhlZCgyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn07"},{"version":3,"sources":["ExportExcelCommon.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <transition name=\"fadeIn\">\n    <div v-show=\"false\">\n      <el-table\n        :id=\"exportExcelInfo.excelId\"\n        :data=\"tableData\"\n        highlight-current-row\n        style=\"width: 100%\"\n      >\n        <template v-for=\"(item,index) in exportExcelArry\">\n          <el-table-column v-if=\"!item.formatterFlag\" :prop=\"item.prop\" :label=\"item.label\"></el-table-column>\n          <el-table-column v-else :prop=\"item.prop\" :label=\"item.label\">\n            <template slot-scope=\"scope\">\n              <span>{{formatter(scope.row[item.prop],item,scope.row,item.prop)}}</span>\n            </template>\n          </el-table-column>\n        </template>\n      </el-table>\n    </div>\n  </transition>\n</template>\n<script>\nimport FileSaver from 'file-saver'\nimport XLSX from 'xlsx'\nexport default {\n  props: {\n    exportExcelInfo: {\n      type: Object,\n      default: []\n    },\n    exportExcelArry: {\n      type: Array,\n      default: []\n    },\n    tableData: {\n      type: Array,\n      default: []\n    }\n  },\n  methods: {\n    // excel导出\n    exportExcel() {\n      var xlsxParam = { raw: true } // 导出的内容只做解析，不进行格式转换\n      var wb = XLSX.utils.table_to_book(\n        document.querySelector('#' + this.exportExcelInfo.excelId),\n        xlsxParam\n      )\n      var wbout = XLSX.write(wb, {\n        bookType: 'xlsx',\n        bookSST: true,\n        type: 'array'\n      })\n      try {\n        FileSaver.saveAs(\n          new Blob([wbout], { type: 'application/octet-stream' }),\n          this.exportExcelInfo.excelName\n        )\n      } catch (e) {\n        if (typeof console !== 'undefined') console.log(e, wbout)\n      }\n      return wbout\n    },\n    // 表格formatter数据格式化\n    formatter(value, item, row, prop) {\n      // 针对table中item多层对象层级的情况\n      if (prop.indexOf('.') > 0) {\n        let temp = prop.split('.')\n        // item中嵌套两层\n        if (temp.length === 2) {\n          let temp = prop.split('.')\n          if (item.formatterType === 'common-type') {\n            // 通用类型转换\n            let arry = item.formatterInfo\n            for (let i in arry) {\n              if (arry[i].value === row[temp[0]][temp[1]]) {\n                return arry[i].label\n              }\n            }\n          } else if (item.formatterType === 'time-type') {\n            // 时间标准格式化\n            if (!global.isNull(row[temp[0]][temp[1]])) {\n              return row[temp[0]][temp[1]].substring(\n                0,\n                row[temp[0]][temp[1]].length - 2\n              )\n            }\n          } else if (item.formatterType === 'amount-type') {\n            // 金额转换\n            return (row[temp[0]][temp[1]] / 100).toFixed(2)\n          }\n        }\n      } else {\n        // item中无嵌套对象\n        let temp = prop.split('.')\n        if (item.formatterType === 'common-type') {\n          // 通用类型转换\n          let arry = item.formatterInfo\n          for (let i in arry) {\n            if (arry[i].value === value) {\n              return arry[i].label\n            }\n          }\n        } else if (item.formatterType === 'time-type') {\n          // 时间标准格式化\n          if (!global.isNull(row[temp[0]][temp[1]])) {\n            return value.substring(0, value.length - 2)\n          }\n        } else if (item.formatterType === 'amount-type') {\n          // 金额转换\n          return (value / 100).toFixed(2)\n        }\n      }\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/components/user"}]}